
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/classifier_wavenet.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_classifier_wavenet.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_classifier_wavenet.py:


DenseNet Classifier: Detecting Regions of Interest in Synthetic Signals
=======================================================================

This example demonstrates how to use DeepPeak's DenseNet classifier to identify
regions of interest (ROIs) in synthetic 1D signals containing Gaussian peaks.

We will:
- Generate a dataset of noisy signals with random Gaussian peaks
- Build and train a DenseNet classifier to detect ROIs
- Visualize the training process and model predictions

.. note::
    This example is fully reproducible and suitable for Sphinx-Gallery documentation.

.. GENERATED FROM PYTHON SOURCE LINES 19-21

Imports and reproducibility
--------------------------

.. GENERATED FROM PYTHON SOURCE LINES 21-30

.. code-block:: Python

    import numpy as np

    from DeepPeak.machine_learning.classifier import WaveNet, BinaryIoU
    from DeepPeak.signals import SignalDatasetGenerator
    from DeepPeak import kernel
    import DeepPeak

    np.random.seed(42)








.. GENERATED FROM PYTHON SOURCE LINES 31-33

Generate synthetic dataset
-------------------------

.. GENERATED FROM PYTHON SOURCE LINES 33-53

.. code-block:: Python

    NUM_PEAKS = 3
    SEQUENCE_LENGTH = 200

    kernel = DeepPeak.kernel.Gaussian(
        amplitude=(10, 20),
        position=(0.1, 0.9),
        width=(0.04 * 1, 0.05 * 1),
    )

    generator = SignalDatasetGenerator(n_samples=1000, sequence_length=SEQUENCE_LENGTH)

    dataset = generator.generate(
        kernel=kernel,
        n_peaks=(1, NUM_PEAKS),
        noise_std=0.03,
        categorical_peak_count=False,
        compute_region_of_interest=True,
    )









.. GENERATED FROM PYTHON SOURCE LINES 54-56

Visualize a few example signals and their regions of interest
------------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 56-58

.. code-block:: Python

    _ = dataset.plot(number_of_samples=6, number_of_columns=3)




.. image-sg:: /gallery/images/sphx_glr_classifier_wavenet_001.png
   :alt: Predicted ROI (Sample 0), Predicted ROI (Sample 1), Predicted ROI (Sample 2), Predicted ROI (Sample 3), Predicted ROI (Sample 4), Predicted ROI (Sample 5)
   :srcset: /gallery/images/sphx_glr_classifier_wavenet_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 59-61

Build and summarize the WaveNet classifier
------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 61-73

.. code-block:: Python

    wavenet = WaveNet(
        sequence_length=SEQUENCE_LENGTH,
        num_filters=64,
        num_dilation_layers=3,
        kernel_size=4,
        optimizer="adam",
        loss="binary_crossentropy",
        metrics=["accuracy", BinaryIoU(threshold=0.5)],
    )

    wavenet.build()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <Functional name=WaveNetDetector, built=True>



.. GENERATED FROM PYTHON SOURCE LINES 74-76

Train the classifier
--------------------

.. GENERATED FROM PYTHON SOURCE LINES 76-84

.. code-block:: Python

    history = wavenet.fit(
        dataset.signals,
        dataset.region_of_interest,
        validation_split=0.2,
        epochs=40,
        batch_size=64,
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Epoch 1/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 26s 2s/step - BinaryIoU: 0.0000e+00 - accuracy: 0.6492 - loss: 0.7138     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.0333 - accuracy: 0.6662 - loss: 0.8902        4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.0686 - accuracy: 0.7175 - loss: 0.8890     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.0770 - accuracy: 0.7573 - loss: 0.8783     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.0792 - accuracy: 0.7851 - loss: 0.8642    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.0791 - accuracy: 0.8053 - loss: 0.8426    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.0847 - accuracy: 0.8197 - loss: 0.8177
    Epoch 1: val_loss improved from None to 0.25263, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 3s 84ms/step - BinaryIoU: 0.1327 - accuracy: 0.8937 - loss: 0.6652 - val_BinaryIoU: 0.0000e+00 - val_accuracy: 0.9501 - val_loss: 0.2526
    Epoch 2/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 3s 262ms/step - BinaryIoU: 0.0000e+00 - accuracy: 0.9538 - loss: 0.2471     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step - BinaryIoU: 0.0000e+00 - accuracy: 0.9528 - loss: 0.2528      3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step - BinaryIoU: 0.0000e+00 - accuracy: 0.9526 - loss: 0.2522     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step - BinaryIoU: 0.0000e+00 - accuracy: 0.9525 - loss: 0.2478     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step - BinaryIoU: 0.0077 - accuracy: 0.9527 - loss: 0.2412         6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step - BinaryIoU: 0.0329 - accuracy: 0.9529 - loss: 0.2345     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step - BinaryIoU: 0.0599 - accuracy: 0.9531 - loss: 0.2281     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.0860 - accuracy: 0.9534 - loss: 0.2220     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.1048 - accuracy: 0.9536 - loss: 0.2161    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.1177 - accuracy: 0.9537 - loss: 0.2108    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.1276 - accuracy: 0.9539 - loss: 0.2058    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.1386 - accuracy: 0.9541 - loss: 0.2011
    Epoch 2: val_loss improved from 0.25263 to 0.09274, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 68ms/step - BinaryIoU: 0.2732 - accuracy: 0.9568 - loss: 0.1471 - val_BinaryIoU: 0.5018 - val_accuracy: 0.9592 - val_loss: 0.0927
    Epoch 3/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 65ms/step - BinaryIoU: 0.5278 - accuracy: 0.9635 - loss: 0.0805     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step - BinaryIoU: 0.5317 - accuracy: 0.9654 - loss: 0.0792     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.4988 - accuracy: 0.9646 - loss: 0.0815     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.4801 - accuracy: 0.9646 - loss: 0.0818     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.4753 - accuracy: 0.9650 - loss: 0.0816     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.4753 - accuracy: 0.9654 - loss: 0.0811     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.4774 - accuracy: 0.9657 - loss: 0.0807     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.4806 - accuracy: 0.9661 - loss: 0.0802     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.4830 - accuracy: 0.9665 - loss: 0.0798    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.4848 - accuracy: 0.9669 - loss: 0.0793    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.4869 - accuracy: 0.9672 - loss: 0.0789    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.4891 - accuracy: 0.9675 - loss: 0.0785
    Epoch 3: val_loss improved from 0.09274 to 0.07162, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 65ms/step - BinaryIoU: 0.5174 - accuracy: 0.9709 - loss: 0.0732 - val_BinaryIoU: 0.5991 - val_accuracy: 0.9758 - val_loss: 0.0716
    Epoch 4/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 65ms/step - BinaryIoU: 0.6032 - accuracy: 0.9767 - loss: 0.0679     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.5944 - accuracy: 0.9772 - loss: 0.0659     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.5833 - accuracy: 0.9769 - loss: 0.0667     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.5828 - accuracy: 0.9770 - loss: 0.0663     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step - BinaryIoU: 0.5834 - accuracy: 0.9770 - loss: 0.0660     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.5831 - accuracy: 0.9769 - loss: 0.0658     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.5838 - accuracy: 0.9768 - loss: 0.0656     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.5832 - accuracy: 0.9768 - loss: 0.0654     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.5831 - accuracy: 0.9767 - loss: 0.0652    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.5833 - accuracy: 0.9767 - loss: 0.0650    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - BinaryIoU: 0.5839 - accuracy: 0.9767 - loss: 0.0648    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - BinaryIoU: 0.5847 - accuracy: 0.9767 - loss: 0.0647
    Epoch 4: val_loss improved from 0.07162 to 0.06727, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 61ms/step - BinaryIoU: 0.5951 - accuracy: 0.9768 - loss: 0.0631 - val_BinaryIoU: 0.5818 - val_accuracy: 0.9762 - val_loss: 0.0673
    Epoch 5/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.5611 - accuracy: 0.9725 - loss: 0.0749     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.5874 - accuracy: 0.9747 - loss: 0.0681     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.5950 - accuracy: 0.9755 - loss: 0.0652     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.5963 - accuracy: 0.9758 - loss: 0.0643     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.5971 - accuracy: 0.9760 - loss: 0.0638     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.5981 - accuracy: 0.9761 - loss: 0.0634     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.5994 - accuracy: 0.9763 - loss: 0.0630    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6006 - accuracy: 0.9764 - loss: 0.0627    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6009 - accuracy: 0.9765 - loss: 0.0622
    Epoch 5: val_loss improved from 0.06727 to 0.06357, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 60ms/step - BinaryIoU: 0.6020 - accuracy: 0.9768 - loss: 0.0601 - val_BinaryIoU: 0.6160 - val_accuracy: 0.9756 - val_loss: 0.0636
    Epoch 6/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.6324 - accuracy: 0.9771 - loss: 0.0603     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.5973 - accuracy: 0.9766 - loss: 0.0602     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.5911 - accuracy: 0.9761 - loss: 0.0608     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.5938 - accuracy: 0.9761 - loss: 0.0605     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.5953 - accuracy: 0.9764 - loss: 0.0600    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.5974 - accuracy: 0.9766 - loss: 0.0595    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.5991 - accuracy: 0.9767 - loss: 0.0592
    Epoch 6: val_loss improved from 0.06357 to 0.05993, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6096 - accuracy: 0.9775 - loss: 0.0574 - val_BinaryIoU: 0.6204 - val_accuracy: 0.9777 - val_loss: 0.0599
    Epoch 7/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.6740 - accuracy: 0.9827 - loss: 0.0507     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6602 - accuracy: 0.9816 - loss: 0.0519     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6557 - accuracy: 0.9811 - loss: 0.0523     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6540 - accuracy: 0.9809 - loss: 0.0526     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6521 - accuracy: 0.9807 - loss: 0.0529     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6509 - accuracy: 0.9806 - loss: 0.0531    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6493 - accuracy: 0.9804 - loss: 0.0532    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6489 - accuracy: 0.9804 - loss: 0.0533
    Epoch 7: val_loss improved from 0.05993 to 0.05771, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6428 - accuracy: 0.9797 - loss: 0.0539 - val_BinaryIoU: 0.6525 - val_accuracy: 0.9785 - val_loss: 0.0577
    Epoch 8/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - BinaryIoU: 0.6843 - accuracy: 0.9813 - loss: 0.0527     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - BinaryIoU: 0.6768 - accuracy: 0.9811 - loss: 0.0520     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6624 - accuracy: 0.9806 - loss: 0.0522     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6595 - accuracy: 0.9805 - loss: 0.0520     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6573 - accuracy: 0.9804 - loss: 0.0518    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6544 - accuracy: 0.9802 - loss: 0.0520    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6532 - accuracy: 0.9801 - loss: 0.0520    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.6517 - accuracy: 0.9801 - loss: 0.0521
    Epoch 8: val_loss improved from 0.05771 to 0.05496, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6433 - accuracy: 0.9797 - loss: 0.0524 - val_BinaryIoU: 0.6505 - val_accuracy: 0.9795 - val_loss: 0.0550
    Epoch 9/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.6608 - accuracy: 0.9803 - loss: 0.0528     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6779 - accuracy: 0.9813 - loss: 0.0513     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6767 - accuracy: 0.9814 - loss: 0.0508     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6735 - accuracy: 0.9813 - loss: 0.0506     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6701 - accuracy: 0.9811 - loss: 0.0507    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6687 - accuracy: 0.9811 - loss: 0.0506    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - BinaryIoU: 0.6675 - accuracy: 0.9811 - loss: 0.0506
    Epoch 9: val_loss did not improve from 0.05496
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.6604 - accuracy: 0.9809 - loss: 0.0505 - val_BinaryIoU: 0.6600 - val_accuracy: 0.9778 - val_loss: 0.0564
    Epoch 10/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.6600 - accuracy: 0.9787 - loss: 0.0537     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6579 - accuracy: 0.9789 - loss: 0.0542     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6589 - accuracy: 0.9795 - loss: 0.0532     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6590 - accuracy: 0.9796 - loss: 0.0529     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6586 - accuracy: 0.9797 - loss: 0.0527     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6587 - accuracy: 0.9798 - loss: 0.0525     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6591 - accuracy: 0.9799 - loss: 0.0523    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6573 - accuracy: 0.9799 - loss: 0.0522    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6569 - accuracy: 0.9799 - loss: 0.0522
    Epoch 10: val_loss did not improve from 0.05496
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 56ms/step - BinaryIoU: 0.6552 - accuracy: 0.9801 - loss: 0.0512 - val_BinaryIoU: 0.5315 - val_accuracy: 0.9751 - val_loss: 0.0613
    Epoch 11/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.5766 - accuracy: 0.9782 - loss: 0.0534     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6134 - accuracy: 0.9790 - loss: 0.0517     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6198 - accuracy: 0.9788 - loss: 0.0521     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6212 - accuracy: 0.9788 - loss: 0.0523     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6223 - accuracy: 0.9788 - loss: 0.0525     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6240 - accuracy: 0.9788 - loss: 0.0526     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6281 - accuracy: 0.9788 - loss: 0.0525    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6299 - accuracy: 0.9789 - loss: 0.0524    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.6320 - accuracy: 0.9790 - loss: 0.0522
    Epoch 11: val_loss improved from 0.05496 to 0.05377, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6439 - accuracy: 0.9795 - loss: 0.0513 - val_BinaryIoU: 0.6311 - val_accuracy: 0.9799 - val_loss: 0.0538
    Epoch 12/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.5911 - accuracy: 0.9777 - loss: 0.0554     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6115 - accuracy: 0.9792 - loss: 0.0529     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6345 - accuracy: 0.9805 - loss: 0.0505     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6443 - accuracy: 0.9808 - loss: 0.0497     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6490 - accuracy: 0.9809 - loss: 0.0495    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6535 - accuracy: 0.9810 - loss: 0.0492    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6576 - accuracy: 0.9812 - loss: 0.0489
    Epoch 12: val_loss improved from 0.05377 to 0.05047, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6803 - accuracy: 0.9822 - loss: 0.0468 - val_BinaryIoU: 0.6789 - val_accuracy: 0.9806 - val_loss: 0.0505
    Epoch 13/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - BinaryIoU: 0.6563 - accuracy: 0.9793 - loss: 0.0517     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6666 - accuracy: 0.9798 - loss: 0.0508     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6683 - accuracy: 0.9804 - loss: 0.0496     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6705 - accuracy: 0.9807 - loss: 0.0490     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6724 - accuracy: 0.9809 - loss: 0.0485     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6761 - accuracy: 0.9813 - loss: 0.0478    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6781 - accuracy: 0.9815 - loss: 0.0475    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.6793 - accuracy: 0.9816 - loss: 0.0472
    Epoch 13: val_loss improved from 0.05047 to 0.04892, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6853 - accuracy: 0.9823 - loss: 0.0461 - val_BinaryIoU: 0.6889 - val_accuracy: 0.9811 - val_loss: 0.0489
    Epoch 14/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7045 - accuracy: 0.9827 - loss: 0.0439     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6888 - accuracy: 0.9815 - loss: 0.0449     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6878 - accuracy: 0.9816 - loss: 0.0449     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6888 - accuracy: 0.9818 - loss: 0.0446     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6889 - accuracy: 0.9819 - loss: 0.0445    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6888 - accuracy: 0.9821 - loss: 0.0444    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - BinaryIoU: 0.6896 - accuracy: 0.9821 - loss: 0.0443
    Epoch 14: val_loss improved from 0.04892 to 0.04685, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 58ms/step - BinaryIoU: 0.6928 - accuracy: 0.9826 - loss: 0.0442 - val_BinaryIoU: 0.6919 - val_accuracy: 0.9815 - val_loss: 0.0468
    Epoch 15/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.7238 - accuracy: 0.9837 - loss: 0.0416     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7171 - accuracy: 0.9833 - loss: 0.0425     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7106 - accuracy: 0.9832 - loss: 0.0427     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7064 - accuracy: 0.9830 - loss: 0.0429     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7030 - accuracy: 0.9828 - loss: 0.0432    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7019 - accuracy: 0.9828 - loss: 0.0432    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - BinaryIoU: 0.7017 - accuracy: 0.9829 - loss: 0.0431
    Epoch 15: val_loss did not improve from 0.04685
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7007 - accuracy: 0.9832 - loss: 0.0427 - val_BinaryIoU: 0.6641 - val_accuracy: 0.9803 - val_loss: 0.0469
    Epoch 16/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.6889 - accuracy: 0.9836 - loss: 0.0380     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6893 - accuracy: 0.9832 - loss: 0.0390     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6864 - accuracy: 0.9827 - loss: 0.0405     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6827 - accuracy: 0.9820 - loss: 0.0424     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6832 - accuracy: 0.9818 - loss: 0.0431     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6832 - accuracy: 0.9818 - loss: 0.0434    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6841 - accuracy: 0.9818 - loss: 0.0435    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6844 - accuracy: 0.9819 - loss: 0.0434
    Epoch 16: val_loss did not improve from 0.04685
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 56ms/step - BinaryIoU: 0.6850 - accuracy: 0.9821 - loss: 0.0430 - val_BinaryIoU: 0.6804 - val_accuracy: 0.9806 - val_loss: 0.0489
    Epoch 17/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 7s 589ms/step - BinaryIoU: 0.6973 - accuracy: 0.9827 - loss: 0.0424     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6913 - accuracy: 0.9825 - loss: 0.0425      5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6919 - accuracy: 0.9826 - loss: 0.0423     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6929 - accuracy: 0.9827 - loss: 0.0422     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6950 - accuracy: 0.9828 - loss: 0.0419    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6942 - accuracy: 0.9827 - loss: 0.0420    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6924 - accuracy: 0.9826 - loss: 0.0422
    Epoch 17: val_loss did not improve from 0.04685
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.6839 - accuracy: 0.9822 - loss: 0.0427 - val_BinaryIoU: 0.6402 - val_accuracy: 0.9734 - val_loss: 0.0578
    Epoch 18/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.6219 - accuracy: 0.9736 - loss: 0.0553     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - BinaryIoU: 0.6356 - accuracy: 0.9758 - loss: 0.0526     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - BinaryIoU: 0.6429 - accuracy: 0.9771 - loss: 0.0515     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6511 - accuracy: 0.9781 - loss: 0.0503     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6604 - accuracy: 0.9791 - loss: 0.0489     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6652 - accuracy: 0.9797 - loss: 0.0479    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6687 - accuracy: 0.9801 - loss: 0.0472    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6697 - accuracy: 0.9802 - loss: 0.0470    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6709 - accuracy: 0.9803 - loss: 0.0467
    Epoch 18: val_loss improved from 0.04685 to 0.04467, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6869 - accuracy: 0.9821 - loss: 0.0432 - val_BinaryIoU: 0.6928 - val_accuracy: 0.9819 - val_loss: 0.0447
    Epoch 19/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.7405 - accuracy: 0.9855 - loss: 0.0362     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7162 - accuracy: 0.9841 - loss: 0.0395     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7059 - accuracy: 0.9833 - loss: 0.0413     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6991 - accuracy: 0.9829 - loss: 0.0418     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6982 - accuracy: 0.9828 - loss: 0.0418     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6973 - accuracy: 0.9827 - loss: 0.0419     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6966 - accuracy: 0.9827 - loss: 0.0420    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6953 - accuracy: 0.9826 - loss: 0.0420    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.6949 - accuracy: 0.9826 - loss: 0.0419
    Epoch 19: val_loss improved from 0.04467 to 0.04289, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.6927 - accuracy: 0.9827 - loss: 0.0414 - val_BinaryIoU: 0.7068 - val_accuracy: 0.9831 - val_loss: 0.0429
    Epoch 20/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.7684 - accuracy: 0.9884 - loss: 0.0333     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7393 - accuracy: 0.9857 - loss: 0.0366     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7332 - accuracy: 0.9854 - loss: 0.0368     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7306 - accuracy: 0.9853 - loss: 0.0369     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7290 - accuracy: 0.9852 - loss: 0.0370    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7284 - accuracy: 0.9851 - loss: 0.0371    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7278 - accuracy: 0.9851 - loss: 0.0372
    Epoch 20: val_loss improved from 0.04289 to 0.04167, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7216 - accuracy: 0.9845 - loss: 0.0381 - val_BinaryIoU: 0.7125 - val_accuracy: 0.9835 - val_loss: 0.0417
    Epoch 21/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.7463 - accuracy: 0.9854 - loss: 0.0352     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7256 - accuracy: 0.9846 - loss: 0.0373     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7242 - accuracy: 0.9847 - loss: 0.0374     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.7249 - accuracy: 0.9848 - loss: 0.0374     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.7242 - accuracy: 0.9848 - loss: 0.0374     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.7229 - accuracy: 0.9848 - loss: 0.0374     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.7205 - accuracy: 0.9846 - loss: 0.0377    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7193 - accuracy: 0.9845 - loss: 0.0379    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7179 - accuracy: 0.9844 - loss: 0.0382
    Epoch 21: val_loss did not improve from 0.04167
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 56ms/step - BinaryIoU: 0.7115 - accuracy: 0.9838 - loss: 0.0395 - val_BinaryIoU: 0.6730 - val_accuracy: 0.9825 - val_loss: 0.0451
    Epoch 22/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step - BinaryIoU: 0.6588 - accuracy: 0.9830 - loss: 0.0414     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.6822 - accuracy: 0.9842 - loss: 0.0385     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7011 - accuracy: 0.9846 - loss: 0.0377     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7069 - accuracy: 0.9846 - loss: 0.0378     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7087 - accuracy: 0.9845 - loss: 0.0379    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7109 - accuracy: 0.9845 - loss: 0.0377    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7129 - accuracy: 0.9846 - loss: 0.0376
    Epoch 22: val_loss improved from 0.04167 to 0.04163, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7211 - accuracy: 0.9846 - loss: 0.0370 - val_BinaryIoU: 0.6793 - val_accuracy: 0.9824 - val_loss: 0.0416
    Epoch 23/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.6568 - accuracy: 0.9820 - loss: 0.0408     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6874 - accuracy: 0.9826 - loss: 0.0400     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.6970 - accuracy: 0.9831 - loss: 0.0399     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7036 - accuracy: 0.9834 - loss: 0.0395     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7058 - accuracy: 0.9836 - loss: 0.0393    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7089 - accuracy: 0.9837 - loss: 0.0391    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7102 - accuracy: 0.9838 - loss: 0.0389    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - BinaryIoU: 0.7123 - accuracy: 0.9839 - loss: 0.0387
    Epoch 23: val_loss improved from 0.04163 to 0.04125, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 58ms/step - BinaryIoU: 0.7247 - accuracy: 0.9848 - loss: 0.0370 - val_BinaryIoU: 0.7273 - val_accuracy: 0.9832 - val_loss: 0.0413
    Epoch 24/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step - BinaryIoU: 0.7500 - accuracy: 0.9866 - loss: 0.0324     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7550 - accuracy: 0.9870 - loss: 0.0320     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7516 - accuracy: 0.9869 - loss: 0.0320     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7503 - accuracy: 0.9868 - loss: 0.0322     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7473 - accuracy: 0.9866 - loss: 0.0327     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7458 - accuracy: 0.9864 - loss: 0.0330    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7453 - accuracy: 0.9863 - loss: 0.0332    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7436 - accuracy: 0.9862 - loss: 0.0335
    Epoch 24: val_loss did not improve from 0.04125
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7361 - accuracy: 0.9855 - loss: 0.0351 - val_BinaryIoU: 0.6413 - val_accuracy: 0.9809 - val_loss: 0.0470
    Epoch 25/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.6822 - accuracy: 0.9840 - loss: 0.0354     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7084 - accuracy: 0.9850 - loss: 0.0340     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7110 - accuracy: 0.9847 - loss: 0.0353     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7094 - accuracy: 0.9844 - loss: 0.0366     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7092 - accuracy: 0.9843 - loss: 0.0370     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7089 - accuracy: 0.9842 - loss: 0.0372    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7079 - accuracy: 0.9841 - loss: 0.0376    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7073 - accuracy: 0.9840 - loss: 0.0379    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7066 - accuracy: 0.9839 - loss: 0.0381
    Epoch 25: val_loss did not improve from 0.04125
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 56ms/step - BinaryIoU: 0.6999 - accuracy: 0.9830 - loss: 0.0409 - val_BinaryIoU: 0.6676 - val_accuracy: 0.9823 - val_loss: 0.0433
    Epoch 26/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - BinaryIoU: 0.6624 - accuracy: 0.9813 - loss: 0.0461     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6752 - accuracy: 0.9827 - loss: 0.0432     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6836 - accuracy: 0.9831 - loss: 0.0423     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6940 - accuracy: 0.9835 - loss: 0.0408     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.6992 - accuracy: 0.9837 - loss: 0.0402     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7037 - accuracy: 0.9839 - loss: 0.0396    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7063 - accuracy: 0.9840 - loss: 0.0394    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - BinaryIoU: 0.7088 - accuracy: 0.9841 - loss: 0.0391
    Epoch 26: val_loss did not improve from 0.04125
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7237 - accuracy: 0.9848 - loss: 0.0374 - val_BinaryIoU: 0.6782 - val_accuracy: 0.9826 - val_loss: 0.0413
    Epoch 27/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7211 - accuracy: 0.9849 - loss: 0.0364     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7276 - accuracy: 0.9853 - loss: 0.0358     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7322 - accuracy: 0.9855 - loss: 0.0353     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7312 - accuracy: 0.9854 - loss: 0.0355     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7305 - accuracy: 0.9854 - loss: 0.0355     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7305 - accuracy: 0.9854 - loss: 0.0355    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7309 - accuracy: 0.9854 - loss: 0.0355    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7305 - accuracy: 0.9854 - loss: 0.0356
    Epoch 27: val_loss improved from 0.04125 to 0.04011, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7315 - accuracy: 0.9852 - loss: 0.0361 - val_BinaryIoU: 0.6809 - val_accuracy: 0.9826 - val_loss: 0.0401
    Epoch 28/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - BinaryIoU: 0.7061 - accuracy: 0.9848 - loss: 0.0345     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7054 - accuracy: 0.9850 - loss: 0.0340     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7144 - accuracy: 0.9853 - loss: 0.0339     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7193 - accuracy: 0.9854 - loss: 0.0340     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7205 - accuracy: 0.9853 - loss: 0.0342    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7219 - accuracy: 0.9853 - loss: 0.0343    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7224 - accuracy: 0.9853 - loss: 0.0343    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7229 - accuracy: 0.9853 - loss: 0.0344
    Epoch 28: val_loss improved from 0.04011 to 0.03680, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7300 - accuracy: 0.9853 - loss: 0.0347 - val_BinaryIoU: 0.7292 - val_accuracy: 0.9849 - val_loss: 0.0368
    Epoch 29/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.7466 - accuracy: 0.9868 - loss: 0.0302     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.7519 - accuracy: 0.9867 - loss: 0.0308     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7462 - accuracy: 0.9863 - loss: 0.0321     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7438 - accuracy: 0.9861 - loss: 0.0327     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7431 - accuracy: 0.9860 - loss: 0.0330    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7431 - accuracy: 0.9860 - loss: 0.0332    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - BinaryIoU: 0.7425 - accuracy: 0.9859 - loss: 0.0334
    Epoch 29: val_loss did not improve from 0.03680
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7395 - accuracy: 0.9858 - loss: 0.0342 - val_BinaryIoU: 0.7316 - val_accuracy: 0.9826 - val_loss: 0.0423
    Epoch 30/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - BinaryIoU: 0.7545 - accuracy: 0.9851 - loss: 0.0369     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7437 - accuracy: 0.9850 - loss: 0.0359     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7377 - accuracy: 0.9850 - loss: 0.0354     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7387 - accuracy: 0.9851 - loss: 0.0350     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7396 - accuracy: 0.9852 - loss: 0.0349    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7406 - accuracy: 0.9852 - loss: 0.0347    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7415 - accuracy: 0.9854 - loss: 0.0345
    Epoch 30: val_loss did not improve from 0.03680
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7488 - accuracy: 0.9864 - loss: 0.0326 - val_BinaryIoU: 0.7329 - val_accuracy: 0.9832 - val_loss: 0.0400
    Epoch 31/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7669 - accuracy: 0.9855 - loss: 0.0355     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7656 - accuracy: 0.9865 - loss: 0.0336     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7607 - accuracy: 0.9866 - loss: 0.0330     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7589 - accuracy: 0.9866 - loss: 0.0326     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7581 - accuracy: 0.9866 - loss: 0.0325    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7579 - accuracy: 0.9867 - loss: 0.0323    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7578 - accuracy: 0.9867 - loss: 0.0323    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.7577 - accuracy: 0.9867 - loss: 0.0322
    Epoch 31: val_loss improved from 0.03680 to 0.03607, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7568 - accuracy: 0.9868 - loss: 0.0320 - val_BinaryIoU: 0.7452 - val_accuracy: 0.9847 - val_loss: 0.0361
    Epoch 32/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.7626 - accuracy: 0.9860 - loss: 0.0337     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7702 - accuracy: 0.9870 - loss: 0.0313     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7702 - accuracy: 0.9871 - loss: 0.0311     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7697 - accuracy: 0.9871 - loss: 0.0311     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7660 - accuracy: 0.9870 - loss: 0.0311    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7636 - accuracy: 0.9869 - loss: 0.0313    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7625 - accuracy: 0.9869 - loss: 0.0313
    Epoch 32: val_loss did not improve from 0.03607
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7471 - accuracy: 0.9862 - loss: 0.0324 - val_BinaryIoU: 0.7367 - val_accuracy: 0.9835 - val_loss: 0.0397
    Epoch 33/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7488 - accuracy: 0.9834 - loss: 0.0407     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7542 - accuracy: 0.9847 - loss: 0.0377     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7511 - accuracy: 0.9849 - loss: 0.0371     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7497 - accuracy: 0.9850 - loss: 0.0367     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7501 - accuracy: 0.9852 - loss: 0.0363     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7503 - accuracy: 0.9853 - loss: 0.0360    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7513 - accuracy: 0.9855 - loss: 0.0354    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.7526 - accuracy: 0.9857 - loss: 0.0349
    Epoch 33: val_loss improved from 0.03607 to 0.03340, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7607 - accuracy: 0.9870 - loss: 0.0316 - val_BinaryIoU: 0.7630 - val_accuracy: 0.9868 - val_loss: 0.0334
    Epoch 34/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - BinaryIoU: 0.7701 - accuracy: 0.9877 - loss: 0.0298     2/13 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - BinaryIoU: 0.7642 - accuracy: 0.9871 - loss: 0.0313     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.7615 - accuracy: 0.9868 - loss: 0.0323     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7586 - accuracy: 0.9867 - loss: 0.0323     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7579 - accuracy: 0.9868 - loss: 0.0320     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7580 - accuracy: 0.9868 - loss: 0.0320    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7581 - accuracy: 0.9868 - loss: 0.0319    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7579 - accuracy: 0.9868 - loss: 0.0318
    Epoch 34: val_loss did not improve from 0.03340
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 56ms/step - BinaryIoU: 0.7573 - accuracy: 0.9869 - loss: 0.0312 - val_BinaryIoU: 0.7443 - val_accuracy: 0.9840 - val_loss: 0.0379
    Epoch 35/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7951 - accuracy: 0.9882 - loss: 0.0286     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.7797 - accuracy: 0.9877 - loss: 0.0302     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7704 - accuracy: 0.9873 - loss: 0.0311     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7684 - accuracy: 0.9872 - loss: 0.0312     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7671 - accuracy: 0.9872 - loss: 0.0313     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7658 - accuracy: 0.9872 - loss: 0.0313    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7652 - accuracy: 0.9872 - loss: 0.0312    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7652 - accuracy: 0.9872 - loss: 0.0312
    Epoch 35: val_loss did not improve from 0.03340
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7618 - accuracy: 0.9872 - loss: 0.0313 - val_BinaryIoU: 0.7341 - val_accuracy: 0.9834 - val_loss: 0.0392
    Epoch 36/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - BinaryIoU: 0.7409 - accuracy: 0.9850 - loss: 0.0334     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7453 - accuracy: 0.9859 - loss: 0.0320     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7503 - accuracy: 0.9862 - loss: 0.0314     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7562 - accuracy: 0.9866 - loss: 0.0309     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7587 - accuracy: 0.9868 - loss: 0.0307    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7607 - accuracy: 0.9869 - loss: 0.0305    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - BinaryIoU: 0.7625 - accuracy: 0.9871 - loss: 0.0303
    Epoch 36: val_loss did not improve from 0.03340
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7737 - accuracy: 0.9878 - loss: 0.0290 - val_BinaryIoU: 0.7505 - val_accuracy: 0.9864 - val_loss: 0.0345
    Epoch 37/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7940 - accuracy: 0.9892 - loss: 0.0302     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7976 - accuracy: 0.9892 - loss: 0.0286     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7977 - accuracy: 0.9891 - loss: 0.0285     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7955 - accuracy: 0.9890 - loss: 0.0282     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7933 - accuracy: 0.9889 - loss: 0.0281     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7923 - accuracy: 0.9888 - loss: 0.0281    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7911 - accuracy: 0.9888 - loss: 0.0280    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.7903 - accuracy: 0.9887 - loss: 0.0280
    Epoch 37: val_loss improved from 0.03340 to 0.03166, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7851 - accuracy: 0.9886 - loss: 0.0279 - val_BinaryIoU: 0.7737 - val_accuracy: 0.9873 - val_loss: 0.0317
    Epoch 38/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7660 - accuracy: 0.9866 - loss: 0.0301     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - BinaryIoU: 0.7727 - accuracy: 0.9871 - loss: 0.0296     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7701 - accuracy: 0.9871 - loss: 0.0301     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7726 - accuracy: 0.9873 - loss: 0.0298     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7740 - accuracy: 0.9875 - loss: 0.0296    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7747 - accuracy: 0.9876 - loss: 0.0295    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7749 - accuracy: 0.9876 - loss: 0.0295
    Epoch 38: val_loss did not improve from 0.03166
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7786 - accuracy: 0.9882 - loss: 0.0287 - val_BinaryIoU: 0.7716 - val_accuracy: 0.9864 - val_loss: 0.0326
    Epoch 39/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.8221 - accuracy: 0.9903 - loss: 0.0241     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.8073 - accuracy: 0.9894 - loss: 0.0253     5/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7981 - accuracy: 0.9891 - loss: 0.0260     7/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7907 - accuracy: 0.9886 - loss: 0.0269     9/13 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - BinaryIoU: 0.7870 - accuracy: 0.9884 - loss: 0.0274    11/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7842 - accuracy: 0.9882 - loss: 0.0278    13/13 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - BinaryIoU: 0.7829 - accuracy: 0.9882 - loss: 0.0280
    Epoch 39: val_loss did not improve from 0.03166
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 55ms/step - BinaryIoU: 0.7761 - accuracy: 0.9879 - loss: 0.0289 - val_BinaryIoU: 0.7186 - val_accuracy: 0.9852 - val_loss: 0.0344
    Epoch 40/40
     1/13 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - BinaryIoU: 0.7430 - accuracy: 0.9879 - loss: 0.0293     3/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7645 - accuracy: 0.9885 - loss: 0.0279     4/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7688 - accuracy: 0.9885 - loss: 0.0277     6/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7750 - accuracy: 0.9886 - loss: 0.0276     8/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7789 - accuracy: 0.9887 - loss: 0.0273    10/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7817 - accuracy: 0.9888 - loss: 0.0271    12/13 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - BinaryIoU: 0.7832 - accuracy: 0.9888 - loss: 0.0271
    Epoch 40: val_loss improved from 0.03166 to 0.02985, saving model to /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5
        13/13 ━━━━━━━━━━━━━━━━━━━━ 1s 59ms/step - BinaryIoU: 0.7907 - accuracy: 0.9890 - loss: 0.0269 - val_BinaryIoU: 0.7850 - val_accuracy: 0.9880 - val_loss: 0.0298
    Restored best model weights from /tmp/wavenet_ckpt_qrcqia5q/best.weights.h5




.. GENERATED FROM PYTHON SOURCE LINES 85-87

Plot training history
---------------------

.. GENERATED FROM PYTHON SOURCE LINES 87-89

.. code-block:: Python

    _ = wavenet.plot_model_history()




.. image-sg:: /gallery/images/sphx_glr_classifier_wavenet_002.png
   :alt: BinaryIoU, accuracy, loss, val_BinaryIoU, val_accuracy, val_loss
   :srcset: /gallery/images/sphx_glr_classifier_wavenet_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 90-92

Predict and visualize on a test signal
--------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 92-93

.. code-block:: Python

    _ = wavenet.plot_prediction(dataset=dataset, number_of_samples=12, number_of_columns=3, threshold=0.1, randomize_signal=True)



.. image-sg:: /gallery/images/sphx_glr_classifier_wavenet_003.png
   :alt: Predicted ROI (Sample 632), Predicted ROI (Sample 89), Predicted ROI (Sample 369), Predicted ROI (Sample 131), Predicted ROI (Sample 354), Predicted ROI (Sample 792), Predicted ROI (Sample 797), Predicted ROI (Sample 952), Predicted ROI (Sample 831), Predicted ROI (Sample 395), Predicted ROI (Sample 693), Predicted ROI (Sample 825)
   :srcset: /gallery/images/sphx_glr_classifier_wavenet_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 38.283 seconds)


.. _sphx_glr_download_gallery_classifier_wavenet.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: classifier_wavenet.ipynb <classifier_wavenet.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: classifier_wavenet.py <classifier_wavenet.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: classifier_wavenet.zip <classifier_wavenet.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
